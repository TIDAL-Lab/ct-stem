
<!-- saved from url=(0034)http://localhost:9000/save-to-html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<style type="text/css">
.model-button {
  background-color: #D3C8E3;
  border-radius: 8px 8px 8px 8px;
  box-shadow: 3px 3px 3px #555555;
  cursor: pointer;
  font-size: 11pt;
  height: 44px;
  margin: 13px;
  text-align: center;
  width: 80px;
}
</style>
</head>
  <body onload="setup();">
    <div style="height:575px;width:707px;padding: 8px;border: 1px solid rgba(0, 0, 0, 0.5);box-shadow: 3px 3px 10px #555;">
      <div id='chart-div' style='width:300px; float: right;'></div>
      <div>
        <div style="width: 350px; border: 1px solid rgba(0, 0, 0, 0.5);padding:8px;margin:6px;text-align:center;">
          <label>speed:<input id="speed-slider" type="range" min="0" max="8" step=".01" style="width: 225px;"></label>
          ticks: <span id="tick-counter">77</span>
        </div>
        <div style="width: 350px; border: 1px solid rgba(0, 0, 0, 0.5);padding:8px;margin:6px;text-align:center;">
          <span style="vertical-align:text-top">cloud coverage:</span>
          <input id="cloud-slider" type="range" min="0" max="100" step="5" style="width: 150px" onchange="onCloudChange()" value="0">
           <span id='cloud-label' style="width: 40px;">0%</span>
        </div>
        <div style="width: 350px; border: 1px solid rgba(0, 0, 0, 0.5);padding:8px;margin:6px;text-align:center;">
          CO2 amount: <input id="co2-slider" type="range" min="0" max="300" step="25" style="width: 150px" onchange="onCO2Change()" value="100">
          <span id='co2-label' style="width: 40px; display: inline-block;">100</span>
        </div>
        <div style="width: 350px; text-align:center;border: 1px solid rgba(0, 0, 0, 0.5); padding:8px;margin:6px;">
          temperature: <span id="temp-monitor">0</span>
        </div>
        <div style="clear: both;"></div>
    </div>
      <div style="width: 565px; display: inline-block; float: right;">
        <div class="view-container" style="width: 565px;">
          <div class="view-layers" style="width: 100%; position: relative;">
            <canvas width="588" height="372" style="width: 100%;"></canvas>
            <canvas width="1764" height="1116" style="width: 100%; position: absolute; top: 0px; left: 0px;"></canvas>
          </div>
        </div>
      </div>
      <input type="button" onclick="setup();" class="model-button" value="Setup"><br/>
      <input id="go-button" type="button"  class="model-button" onclick="toggleGo();" value="Go">
      <div style="clear: both;"></div>
      <div class="powered-by" style="float:right;">
        Powered by <a href="http://ccl.northwestern.edu/netlogo" target="_blank" style="text-decoration:none;cursor:pointer;color:black;">NetLogo <img src="netlogo-icon.jpg" height="20px;" style="vertical-align:bottom"/></a>
      </div>
    </div>
    <script type="text/javascript">
      var Cloner, Random, StrictMath, println, typeIsArray;

if (!Array.prototype.filter) {
  Array.prototype.filter = function(callback) {
    var element, _i, _len, _results;
    _results = [];
    for (_i = 0, _len = this.length; _i < _len; _i++) {
      element = this[_i];
      if (callback(element)) {
        _results.push(element);
      }
    }
    return _results;
  };
}

if (typeof println === "undefined" || println === null) {
  if (typeof console !== "undefined" && console !== null) {
    println = console.log;
  }
  if (println == null) {
    println = java.lang.System.out.println;
  }
}

typeIsArray = function(value) {
  return value && typeof value === 'object' && value instanceof Array && typeof value.length === 'number' && typeof value.splice === 'function' && !(value.propertyIsEnumerable('length'));
};

if (typeof Random === "undefined" || Random === null) {
  Random = {};
  Random.nextInt = function(limit) {
    return Math.floor(Math.random() * limit);
  };
  Random.nextLong = Random.nextInt;
  Random.nextDouble = function() {
    return Math.random();
  };
}

Cloner = {
  clone: function(obj) {
    var key, temp, _i, _len, _ref;
    if (obj === null || typeof obj !== "object") {
      return obj;
    }
    temp = new obj.constructor();
    _ref = Object.getOwnPropertyNames(obj);
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      key = _ref[_i];
      temp[key] = this.clone(obj[key]);
    }
    return temp;
  }
};

if (typeof StrictMath === "undefined" || StrictMath === null) {
  StrictMath = Cloner.clone(Math);
  StrictMath.toRadians = function(degrees) {
    return degrees * Math.PI / 180;
  };
}
;
var AgentSet, Agents, Breed, Breeds, Dump, Globals, Iterator, Nobody, Patch, PatchesOwn, Prims, Shufflerator, Torus, Trig, Turtle, TurtlesOwn, Updates, VertCylinder, World, collectUpdates, died, patchBuiltins, turtleBuiltins, updated,
  __slice = [].slice,
  __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

turtleBuiltins = ["id", "color", "heading", "xcor", "ycor", "shape", "label", "labelcolor", "breed", "hidden", "size", "pensize", "penmode"];

patchBuiltins = ["pxcor", "pycor", "pcolor", "plabel", "plabelcolor"];

Updates = [];

Nobody = {
  toString: function() {
    return "nobody";
  }
};

collectUpdates = function() {
  var result;
  result = Updates.length === 0 ? [
    {
      turtles: {},
      patches: {}
    }
  ] : Updates;
  Updates = [];
  return result;
};

died = function(id) {
  var update;
  update = {
    patches: {},
    turtles: {}
  };
  update.turtles[id] = {
    WHO: -1
  };
  Updates.push(update);
};

updated = function() {
  var change, obj, oneUpdate, update, v, vars, _i, _len;
  obj = arguments[0], vars = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
  change = {};
  for (_i = 0, _len = vars.length; _i < _len; _i++) {
    v = vars[_i];
    if (v === "plabelcolor") {
      change["PLABEL-COLOR"] = obj[v];
    } else if (v === "breed") {
      change["BREED"] = obj[v].name;
    } else if (v === "labelcolor") {
      change["LABEL-COLOR"] = obj[v];
    } else if (v === "pensize") {
      change["PEN-SIZE"] = obj[v];
    } else if (v === "penmode") {
      change["PEN-MODE"] = obj[v];
    } else if (v === "hidden") {
      change["HIDDEN?"] = obj[v];
    } else if (v === "id") {
      change["WHO"] = obj[v];
    } else {
      change[v.toUpperCase()] = obj[v];
    }
  }
  oneUpdate = {};
  oneUpdate[obj.id] = change;
  update = {};
  if (obj instanceof Turtle) {
    update.turtles = oneUpdate;
    update.patches = {};
  } else if (obj instanceof Patch) {
    update.turtles = {};
    update.patches = oneUpdate;
  }
  Updates.push(update);
};

Turtle = (function() {

  Turtle.prototype.vars = [];

  function Turtle(color, heading, xcor, ycor, breed, label, labelcolor, hidden, size, pensize, penmode) {
    var x;
    this.color = color != null ? color : 0;
    this.heading = heading != null ? heading : 0;
    this.xcor = xcor != null ? xcor : 0;
    this.ycor = ycor != null ? ycor : 0;
    if (breed == null) {
      breed = Breeds.get("TURTLES");
    }
    this.label = label != null ? label : "";
    this.labelcolor = labelcolor != null ? labelcolor : 9.9;
    this.hidden = hidden != null ? hidden : false;
    this.size = size != null ? size : 1.0;
    this.pensize = pensize != null ? pensize : 1.0;
    this.penmode = penmode != null ? penmode : "up";
    this.breedvars = {};
    this.updateBreed(breed);
    this.vars = (function() {
      var _i, _len, _ref, _results;
      _ref = TurtlesOwn.vars;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        x = _ref[_i];
        _results.push(x);
      }
      return _results;
    })();
  }

  Turtle.prototype.updateBreed = function(breed) {
    var x, _i, _len, _ref, _results;
    this.breed = breed;
    this.shape = this.breed.shape;
    if (this.breed !== Breeds.get("TURTLES")) {
      _ref = this.breed.vars;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        x = _ref[_i];
        if (this.breedvars[x] === void 0) {
          _results.push(this.breedvars[x] = 0);
        } else {
          _results.push(void 0);
        }
      }
      return _results;
    }
  };

  Turtle.prototype.setBreed = function(breed) {
    this.updateBreed(breed);
    updated(this, "breed");
    return updated(this, "shape");
  };

  Turtle.prototype.toString = function() {
    return "(" + this.breed.singular + " " + this.id + ")";
  };

  Turtle.prototype.keepHeadingInRange = function() {
    if (this.heading < 0 || this.heading >= 360) {
      this.heading = ((this.heading % 360) + 360) % 360;
    }
  };

  Turtle.prototype.canMove = function(amount) {
    return this.patchAhead(amount) !== Nobody;
  };

  Turtle.prototype.patchAhead = function(amount) {
    var newX, newY;
    try {
      newX = world.topology().wrapX(this.xcor + amount * Trig.sin(this.heading), world.minPxcor - 0.5, world.maxPxcor + 0.5);
      newY = world.topology().wrapY(this.ycor + amount * Trig.cos(this.heading), world.minPycor - 0.5, world.maxPycor + 0.5);
      return world.getPatchAt(newX, newY);
    } catch (error) {
      return Nobody;
    }
  };

  Turtle.prototype.fd = function(amount) {
    this.xcor = world.topology().wrap(this.xcor + amount * Trig.sin(this.heading), world.minPxcor - 0.5, world.maxPxcor + 0.5);
    this.ycor = world.topology().wrap(this.ycor + amount * Trig.cos(this.heading), world.minPycor - 0.5, world.maxPycor + 0.5);
    updated(this, "xcor", "ycor");
  };

  Turtle.prototype.right = function(amount) {
    this.heading += amount;
    this.keepHeadingInRange();
    updated(this, "heading");
  };

  Turtle.prototype.setxy = function(x, y) {
    this.xcor = x;
    this.ycor = y;
    updated(this, "xcor", "ycor");
  };

  Turtle.prototype.isBreed = function(breedName) {
    return this.breed.name === breedName;
  };

  Turtle.prototype.die = function() {
    var deathError;
    if (this.id !== -1) {
      world.removeTurtle(this.id);
      died(this.id);
      this.id = -1;
    }
    deathError = new Error("Call only from inside an askAgent block");
    deathError.death = true;
    throw deathError;
  };

  Turtle.prototype.getTurtleVariable = function(n) {
    if (n < turtleBuiltins.length) {
      return this[turtleBuiltins[n]];
    } else {
      return this.vars[n - turtleBuiltins.length];
    }
  };

  Turtle.prototype.setTurtleVariable = function(n, v) {
    if (n < turtleBuiltins.length) {
      if (n === 5) {
        v = v.toLowerCase();
      }
      this[turtleBuiltins[n]] = v;
      if (n === 2) {
        this.keepHeadingInRange();
      }
      return updated(this, turtleBuiltins[n]);
    } else {
      return this.vars[n - turtleBuiltins.length] = v;
    }
  };

  Turtle.prototype.getBreedVariable = function(n) {
    return this.breedvars[n];
  };

  Turtle.prototype.setBreedVariable = function(n, v) {
    return this.breedvars[n] = v;
  };

  Turtle.prototype.getPatchHere = function() {
    return world.getPatchAt(this.xcor, this.ycor);
  };

  Turtle.prototype.getPatchVariable = function(n) {
    return this.getPatchHere().getPatchVariable(n);
  };

  Turtle.prototype.setPatchVariable = function(n, v) {
    return this.getPatchHere().setPatchVariable(n, v);
  };

  Turtle.prototype.turtlesHere = function() {
    var p, t;
    p = this.getPatchHere();
    return new Agents((function() {
      var _i, _len, _ref, _results;
      _ref = world.turtles().items;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        t = _ref[_i];
        if (t.getPatchHere() === p) {
          _results.push(t);
        }
      }
      return _results;
    })(), Breeds.get("TURTLES"));
  };

  Turtle.prototype.breedHere = function(breedName) {
    var p, t;
    p = this.getPatchHere();
    return new Agents((function() {
      var _i, _len, _ref, _results;
      _ref = world.turtlesOfBreed(breedName).items;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        t = _ref[_i];
        if (t.getPatchHere() === p) {
          _results.push(t);
        }
      }
      return _results;
    })(), Breeds.get(breedName));
  };

  Turtle.prototype.hatch = function(n, breedName) {
    var breed, newTurtles, num, t, v, _i, _j, _len, _ref;
    breed = breedName ? Breeds.get(breedName) : this.breed;
    newTurtles = [];
    for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
      t = new Turtle(this.color, this.heading, this.xcor, this.ycor, breed, this.label, this.labelcolor, this.hidden, this.size, this.pensize, this.penmode);
      _ref = TurtlesOwn.vars;
      for (_j = 0, _len = _ref.length; _j < _len; _j++) {
        v = _ref[_j];
        t.setTurtleVariable(turtleBuiltins.length + v, this.getTurtleVariable(turtleBuiltins.length + v));
      }
      newTurtles.push(world.createturtle(t));
    }
    return new Agents(newTurtles, breed);
  };

  return Turtle;

})();

Patch = (function() {

  Patch.prototype.vars = [];

  function Patch(id, pxcor, pycor, pcolor, plabel, plabelcolor) {
    var x;
    this.id = id;
    this.pxcor = pxcor;
    this.pycor = pycor;
    this.pcolor = pcolor != null ? pcolor : 0.0;
    this.plabel = plabel != null ? plabel : "";
    this.plabelcolor = plabelcolor != null ? plabelcolor : 9.9;
    this.vars = (function() {
      var _i, _len, _ref, _results;
      _ref = PatchesOwn.vars;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        x = _ref[_i];
        _results.push(x);
      }
      return _results;
    })();
  }

  Patch.prototype.toString = function() {
    return "(patch " + this.pxcor + " " + this.pycor + ")";
  };

  Patch.prototype.getPatchVariable = function(n) {
    if (n < patchBuiltins.length) {
      return this[patchBuiltins[n]];
    } else {
      return this.vars[n - patchBuiltins.length];
    }
  };

  Patch.prototype.setPatchVariable = function(n, v) {
    if (n < patchBuiltins.length) {
      this[patchBuiltins[n]] = v;
      if (patchBuiltins[n] === "pcolor" && v !== 0) {
        world.patchesAllBlack(false);
      }
      return updated(this, patchBuiltins[n]);
    } else {
      return this.vars[n - patchBuiltins.length] = v;
    }
  };

  Patch.prototype.getNeighbors = function() {
    return world.getNeighbors(this.pxcor, this.pycor);
  };

  Patch.prototype.getNeighbors4 = function() {
    return world.getNeighbors4(this.pxcor, this.pycor);
  };

  Patch.prototype.sprout = function(n) {
    var num;
    return new Agents((function() {
      var _i, _results;
      _results = [];
      for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
        _results.push(world.createturtle(new Turtle(5 + 10 * Random.nextInt(14), Random.nextInt(360), this.pxcor, this.pycor)));
      }
      return _results;
    }).call(this), Breeds.get("TURTLES"));
  };

  return Patch;

})();

World = (function() {
  var width, _nextId, _patches, _patchesAllBlack, _ticks, _topology, _turtles;

  _nextId = 0;

  _turtles = [];

  _patches = [];

  width = 0;

  _topology = null;

  _ticks = -1;

  _patchesAllBlack = true;

  function World(minPxcor, maxPxcor, minPycor, maxPycor, patchSize, wrappingAllowedInY, wrappingAllowedInX, interfaceGlobalCount) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
    this.patchSize = patchSize;
    this.wrappingAllowedInY = wrappingAllowedInY;
    this.wrappingAllowedInX = wrappingAllowedInX;
    this.interfaceGlobalCount = interfaceGlobalCount;
    collectUpdates();
    Updates.push({
      world: {
        0: {
          worldWidth: Math.abs(this.minPxcor - this.maxPxcor) + 1,
          worldHeight: Math.abs(this.minPycor - this.maxPycor) + 1,
          minPxcor: this.minPxcor,
          minPycor: this.minPycor,
          maxPxcor: this.maxPxcor,
          maxPycor: this.maxPycor,
          nbInterfaceGlobals: this.interfaceGlobalCount,
          linkBreeds: "XXX IMPLEMENT ME",
          linkShapeList: "XXX IMPLEMENT ME",
          patchSize: this.patchSize,
          patchesAllBlack: _patchesAllBlack,
          patchesWithLabels: 0,
          ticks: _ticks,
          turtleBreeds: "XXX IMPLEMENT ME",
          turtleShapeList: "XXX IMPLEMENT ME",
          unbreededLinksAreDirected: false,
          wrappingAllowedInX: this.wrappingAllowedInX,
          wrappingAllowedInY: this.wrappingAllowedInY
        }
      }
    });
    this.resize(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
  }

  World.prototype.createPatches = function() {
    var nested, p, x, y, _i, _len, _ref, _results;
    nested = (function() {
      var _i, _ref, _ref1, _results;
      _results = [];
      for (y = _i = _ref = this.maxPycor, _ref1 = this.minPycor; _ref <= _ref1 ? _i <= _ref1 : _i >= _ref1; y = _ref <= _ref1 ? ++_i : --_i) {
        _results.push((function() {
          var _j, _ref2, _ref3, _results1;
          _results1 = [];
          for (x = _j = _ref2 = this.minPxcor, _ref3 = this.maxPxcor; _ref2 <= _ref3 ? _j <= _ref3 : _j >= _ref3; x = _ref2 <= _ref3 ? ++_j : --_j) {
            _results1.push(new Patch((width * (this.maxPycor - y)) + x - this.minPxcor, x, y));
          }
          return _results1;
        }).call(this));
      }
      return _results;
    }).call(this);
    _patches = (_ref = []).concat.apply(_ref, nested);
    _results = [];
    for (_i = 0, _len = _patches.length; _i < _len; _i++) {
      p = _patches[_i];
      _results.push(updated(p, "pxcor", "pycor", "pcolor", "plabel", "plabelcolor"));
    }
    return _results;
  };

  World.prototype.topology = function() {
    return _topology;
  };

  World.prototype.turtles = function() {
    return new Agents(_turtles, Breeds.get("TURTLES"));
  };

  World.prototype.turtlesOfBreed = function(breedName) {
    var breed;
    breed = Breeds.get(breedName);
    return new Agents(_turtles.filter(function(t) {
      return t.breed === breed;
    }), breed);
  };

  World.prototype.patches = function() {
    return new Agents(_patches);
  };

  World.prototype.resetTicks = function() {
    _ticks = 0;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.clearTicks = function() {
    _ticks = -1;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.resize = function(minPxcor, maxPxcor, minPycor, maxPycor) {
    var t, _i, _len, _ref;
    if (minPxcor > 0 || maxPxcor < 0 || minPycor > 0 || maxPycor < 0) {
      throw new Error("You must include the point (0, 0) in the world");
    }
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
    width = (this.maxPxcor - this.minPxcor) + 1;
    if (this.wrappingAllowedInX && this.wrappingAllowedInY) {
      _topology = new Torus(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
    } else if (this.wrappingAllowedInX) {
      _topology = new VertCylinder(this.minPxcor, this.maxPxcor, this.minPycor, this.maxPycor);
    }
    _ref = this.turtles().items;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      t = _ref[_i];
      try {
        t.die();
      } catch (error) {
        if (!error.death) {
          throw error;
        }
      }
    }
    this.createPatches();
    return Updates.push({
      world: {
        0: {
          worldWidth: Math.abs(this.minPxcor - this.maxPxcor) + 1,
          worldHeight: Math.abs(this.minPycor - this.maxPycor) + 1,
          minPxcor: this.minPxcor,
          minPycor: this.minPycor,
          maxPxcor: this.maxPxcor,
          maxPycor: this.maxPycor
        }
      }
    });
  };

  World.prototype.tick = function() {
    if (_ticks === -1) {
      throw new Error("Need to call reset-ticks");
    }
    _ticks++;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.advancetick = function(n) {
    if (_ticks === -1) {
      throw new Error("Need to call reset-ticks");
    }
    if (n < 0) {
      throw new Error("Cannot advance ticks by a negative amount");
    }
    _ticks += n;
    return Updates.push({
      world: {
        0: {
          ticks: _ticks
        }
      }
    });
  };

  World.prototype.ticks = function() {
    if (_ticks === -1) {
      throw new Error("Need to call reset-ticks");
    }
    return _ticks;
  };

  World.prototype.getPatchAt = function(x, y) {
    var index;
    index = (this.maxPycor - StrictMath.round(y)) * width + (StrictMath.round(x) - this.minPxcor);
    return _patches[index];
  };

  World.prototype.getTurtle = function(id) {
    var filteredTurtles;
    filteredTurtles = this.turtles().items.filter(function(t) {
      return t.id === id;
    });
    if (filteredTurtles.length === 0) {
      return Nobody;
    } else {
      return filteredTurtles[0];
    }
  };

  World.prototype.getTurtleOfBreed = function(breedName, id) {
    var filteredTurtles;
    filteredTurtles = this.turtlesOfBreed(breedName).items.filter(function(t) {
      return t.id === id;
    });
    if (filteredTurtles.length === 0) {
      return Nobody;
    } else {
      return filteredTurtles[0];
    }
  };

  World.prototype.removeTurtle = function(id) {
    _turtles = this.turtles().items.filter(function(t) {
      return t.id !== id;
    });
  };

  World.prototype.patchesAllBlack = function(val) {
    _patchesAllBlack = val;
    return Updates.push({
      world: {
        0: {
          patchesAllBlack: _patchesAllBlack
        }
      }
    });
  };

  World.prototype.clearall = function() {
    var t, _i, _len, _ref;
    Globals.clear(this.interfaceGlobalCount);
    _ref = this.turtles().items;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      t = _ref[_i];
      try {
        t.die();
      } catch (error) {
        if (!error.death) {
          throw error;
        }
      }
    }
    this.createPatches();
    _nextId = 0;
    this.patchesAllBlack(true);
    this.clearTicks();
  };

  World.prototype.createturtle = function(t) {
    t.id = _nextId++;
    updated.apply(null, [t].concat(__slice.call(turtleBuiltins)));
    _turtles.push(t);
    return t;
  };

  World.prototype.createorderedturtles = function(n, breedName) {
    var num;
    return new Agents((function() {
      var _i, _results;
      _results = [];
      for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
        _results.push(this.createturtle(new Turtle((num * 10 + 5) % 140, num * (360 / n), 0, 0, Breeds.get(breedName))));
      }
      return _results;
    }).call(this));
  };

  World.prototype.createturtles = function(n, breedName) {
    var num;
    return new Agents((function() {
      var _i, _results;
      _results = [];
      for (num = _i = 0; 0 <= n ? _i < n : _i > n; num = 0 <= n ? ++_i : --_i) {
        _results.push(this.createturtle(new Turtle(5 + 10 * Random.nextInt(14), Random.nextInt(360), 0, 0, Breeds.get(breedName))));
      }
      return _results;
    }).call(this));
  };

  World.prototype.getNeighbors = function(pxcor, pycor) {
    return this.topology().getNeighbors(pxcor, pycor);
  };

  World.prototype.getNeighbors4 = function(pxcor, pycor) {
    return this.topology().getNeighbors4(pxcor, pycor);
  };

  return World;

})();

AgentSet = {
  count: function(x) {
    return x.items.length;
  },
  any: function(x) {
    return x.items.length > 0;
  },
  _self: 0,
  self: function() {
    return this._self;
  },
  askAgent: function(a, f) {
    var oldAgent, res;
    oldAgent = this._self;
    this._self = a;
    try {
      res = f();
    } catch (error) {
      if (!error.death) {
        throw error;
      }
    }
    this._self = oldAgent;
    return res;
  },
  ask: function(agentsOrAgent, shuffle, f) {
    var a, agents, iter;
    if (agentsOrAgent.items) {
      agents = agentsOrAgent.items;
    } else {
      agents = [agentsOrAgent];
    }
    iter = shuffle ? new Shufflerator(agents) : new Iterator(agents);
    while (iter.hasNext()) {
      a = iter.next();
      this.askAgent(a, f);
    }
  },
  agentFilter: function(agents, f) {
    var a;
    return new Agents((function() {
      var _i, _len, _ref, _results;
      _ref = agents.items;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        a = _ref[_i];
        if (this.askAgent(a, f)) {
          _results.push(a);
        }
      }
      return _results;
    }).call(this));
  },
  of: function(agentsOrAgent, f) {
    var a, agents, isagentset, iter, result;
    isagentset = agentsOrAgent.items;
    if (isagentset) {
      agents = agentsOrAgent.items;
    } else {
      agents = [agentsOrAgent];
    }
    result = [];
    iter = new Shufflerator(agents);
    while (iter.hasNext()) {
      a = iter.next();
      result.push(this.askAgent(a, f));
    }
    if (isagentset) {
      return result;
    } else {
      return result[0];
    }
  },
  oneOf: function(agentsOrList) {
    var isagentset, l;
    isagentset = agentsOrList.items;
    if (isagentset) {
      l = agentsOrList.items;
    } else {
      l = agentsOrList;
    }
    if (l.length === 0) {
      return Nobody;
    } else {
      return l[Random.nextInt(l.length)];
    }
  },
  die: function() {
    return this._self.die();
  },
  getTurtleVariable: function(n) {
    return this._self.getTurtleVariable(n);
  },
  setTurtleVariable: function(n, v) {
    return this._self.setTurtleVariable(n, v);
  },
  getBreedVariable: function(n) {
    return this._self.getBreedVariable(n);
  },
  setBreedVariable: function(n, v) {
    return this._self.setBreedVariable(n, v);
  },
  setBreed: function(agentSet) {
    return this._self.setBreed(agentSet.breed);
  },
  getPatchVariable: function(n) {
    return this._self.getPatchVariable(n);
  },
  setPatchVariable: function(n, v) {
    return this._self.setPatchVariable(n, v);
  }
};

Agents = (function() {

  function Agents(items, breed) {
    this.items = items;
    this.breed = breed;
  }

  return Agents;

})();

Iterator = (function() {

  function Iterator(agents) {
    this.agents = agents;
  }

  Iterator.prototype.i = 0;

  Iterator.prototype.hasNext = function() {
    return this.i < this.agents.length;
  };

  Iterator.prototype.next = function() {
    var result;
    result = this.agents[this.i];
    this.i = this.i + 1;
    return result;
  };

  return Iterator;

})();

Shufflerator = (function() {

  function Shufflerator(agents) {
    this.agents = agents;
    this.agents = this.agents.slice(0);
    this.fetch();
  }

  Shufflerator.prototype.i = 0;

  Shufflerator.prototype.nextOne = null;

  Shufflerator.prototype.hasNext = function() {
    return this.nextOne !== null;
  };

  Shufflerator.prototype.next = function() {
    var result;
    result = this.nextOne;
    this.fetch();
    return result;
  };

  Shufflerator.prototype.fetch = function() {
    var r;
    if (this.i >= this.agents.length) {
      this.nextOne = null;
    } else {
      if (this.i < this.agents.length - 1) {
        r = this.i + Random.nextInt(this.agents.length - this.i);
        this.nextOne = this.agents[r];
        this.agents[r] = this.agents[this.i];
      } else {
        this.nextOne = this.agents[this.i];
      }
      this.i = this.i + 1;
    }
  };

  return Shufflerator;

})();

Prims = {
  fd: function(n) {
    return AgentSet.self().fd(n);
  },
  bk: function(n) {
    return AgentSet.self().fd(-n);
  },
  right: function(n) {
    return AgentSet.self().right(n);
  },
  left: function(n) {
    return AgentSet.self().right(-n);
  },
  setxy: function(x, y) {
    return AgentSet.self().setxy(x, y);
  },
  getNeighbors: function() {
    return AgentSet.self().getNeighbors();
  },
  getNeighbors4: function() {
    return AgentSet.self().getNeighbors4();
  },
  sprout: function(n) {
    return AgentSet.self().sprout(n);
  },
  hatch: function(n, breedName) {
    return AgentSet.self().hatch(n, breedName);
  },
  patch: function(x, y) {
    return world.getPatchAt(x, y);
  },
  randomxcor: function() {
    return world.minPxcor - 0.5 + Random.nextDouble() * (world.maxPxcor - world.minPxcor + 1);
  },
  randomycor: function() {
    return world.minPycor - 0.5 + Random.nextDouble() * (world.maxPycor - world.minPycor + 1);
  },
  shadeOf: function(c1, c2) {
    return Math.floor(c1 / 10) === Math.floor(c2 / 10);
  },
  scaleColor: function(color, number, min, max) {
    var perc, tempmax, tempval;
    color = Math.floor(color / 10) * 10;
    perc = 0.0;
    if (min > max) {
      if (number < max) {
        perc = 1.0;
      } else if (number > min) {
        perc = 0.0;
      } else {
        tempval = min - number;
        tempmax = min - max;
        perc = tempval / tempmax;
      }
    } else {
      if (number > max) {
        perc = 1.0;
      } else if (number < min) {
        perc = 0.0;
      } else {
        tempval = number - min;
        tempmax = max - min;
        perc = tempval / tempmax;
      }
    }
    perc *= 10;
    if (perc >= 9.9999) {
      perc = 9.9999;
    }
    if (perc < 0) {
      perc = 0;
    }
    return color + perc;
  },
  randomfloat: function(n) {
    return n * Random.nextDouble();
  },
  list: function() {
    var xs;
    xs = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return xs;
  },
  first: function(xs) {
    return xs[0];
  },
  last: function(xs) {
    return xs[xs.length - 1];
  },
  fput: function(x, xs) {
    return [x].concat(xs);
  },
  lput: function(x, xs) {
    var result;
    result = xs.slice(0);
    result.push(x);
    return result;
  },
  butfirst: function(xs) {
    return xs.slice(1);
  },
  butlast: function(xs) {
    return xs.slice(0, +(xs.length - 1) + 1 || 9e9);
  },
  max: function(xs) {
    return Math.max.apply(Math, xs);
  },
  min: function(xs) {
    return Math.min.apply(Math, xs);
  },
  sum: function(xs) {
    return xs.reduce(function(a, b) {
      return a + b;
    });
  },
  sort: function(xs) {
    return xs.sort();
  },
  removeDuplicates: function(xs) {
    var key, result, value, _i, _ref, _results;
    result = {};
    for (key = _i = 0, _ref = xs.length; 0 <= _ref ? _i < _ref : _i > _ref; key = 0 <= _ref ? ++_i : --_i) {
      result[xs[key]] = xs[key];
    }
    _results = [];
    for (key in result) {
      value = result[key];
      _results.push(value);
    }
    return _results;
  },
  outputprint: function(x) {
    return println(Dump(x));
  },
  patchset: function() {
    var inputs, recurse, result;
    inputs = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    result = [];
    recurse = function(inputs) {
      var agent, input, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = inputs.length; _i < _len; _i++) {
        input = inputs[_i];
        if (typeIsArray(input)) {
          _results.push(recurse(input));
        } else {
          _results.push((function() {
            var _j, _len1, _ref, _results1;
            _ref = input.items;
            _results1 = [];
            for (_j = 0, _len1 = _ref.length; _j < _len1; _j++) {
              agent = _ref[_j];
              if (!(__indexOf.call(result, agent) >= 0)) {
                _results1.push(result.push(agent));
              } else {
                _results1.push(void 0);
              }
            }
            return _results1;
          })());
        }
      }
      return _results;
    };
    recurse(inputs);
    return new Agents(result);
  }
};

Globals = {
  vars: [],
  init: function(n) {
    var x;
    return this.vars = (function() {
      var _i, _results;
      _results = [];
      for (x = _i = 0; 0 <= n ? _i < n : _i > n; x = 0 <= n ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
  },
  clear: function(n) {
    var i, _i, _ref;
    for (i = _i = n, _ref = this.vars.length; n <= _ref ? _i < _ref : _i > _ref; i = n <= _ref ? ++_i : --_i) {
      this.vars[i] = 0;
    }
  },
  getGlobal: function(n) {
    return this.vars[n];
  },
  setGlobal: function(n, v) {
    return this.vars[n] = v;
  }
};

TurtlesOwn = {
  vars: [],
  init: function(n) {
    var x;
    return this.vars = (function() {
      var _i, _ref, _results;
      _results = [];
      for (x = _i = 0, _ref = n - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; x = 0 <= _ref ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
  }
};

PatchesOwn = {
  vars: [],
  init: function(n) {
    var x;
    return this.vars = (function() {
      var _i, _ref, _results;
      _results = [];
      for (x = _i = 0, _ref = n - 1; 0 <= _ref ? _i <= _ref : _i >= _ref; x = 0 <= _ref ? ++_i : --_i) {
        _results.push(0);
      }
      return _results;
    })();
  }
};

Dump = function(x) {
  var x2;
  if (typeIsArray(x)) {
    return "[" + ((function() {
      var _i, _len, _results;
      _results = [];
      for (_i = 0, _len = x.length; _i < _len; _i++) {
        x2 = x[_i];
        _results.push(Dump(x2));
      }
      return _results;
    })()).join(" ") + "]";
  } else {
    return "" + x;
  }
};

Trig = {
  squash: function(x) {
    if (StrictMath.abs(x) < 3.2e-15) {
      return 0;
    } else {
      return x;
    }
  },
  sin: function(degrees) {
    return this.squash(StrictMath.sin(StrictMath.toRadians(degrees)));
  },
  cos: function(degrees) {
    return this.squash(StrictMath.cos(StrictMath.toRadians(degrees)));
  },
  unsquashedSin: function(degrees) {
    return StrictMath.sin(StrictMath.toRadians(degrees));
  },
  unsquashedCos: function(degrees) {
    return StrictMath.cos(StrictMath.toRadians(degrees));
  }
};

Breed = (function() {

  function Breed(name, singular) {
    this.name = name;
    this.singular = singular;
  }

  Breed.prototype.shape = "default";

  Breed.prototype.vars = [];

  return Breed;

})();

Breeds = {
  breeds: [new Breed("TURTLES", "turtle")],
  add: function(name, singular) {
    return this.breeds.push(new Breed(name, singular));
  },
  get: function(name) {
    return (this.breeds.filter(function(b) {
      return b.name === name;
    }))[0];
  },
  setDefaultShape: function(agents, shape) {
    return agents.breed.shape = shape.toLowerCase();
  }
};

Torus = (function() {

  function Torus(minPxcor, maxPxcor, minPycor, maxPycor) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
  }

  Torus.prototype.wrap = function(pos, min, max) {
    var result;
    if (pos >= max) {
      return min + ((pos - max) % (max - min));
    } else if (pos < min) {
      result = max - ((min - pos) % (max - min));
      if (result < max) {
        return result;
      } else {
        return min;
      }
    } else {
      return pos;
    }
  };

  Torus.prototype.wrapX = function(pos) {
    return this.wrap(pos, this.minPxcor - 0.5, this.maxPxcor + 0.5);
  };

  Torus.prototype.wrapY = function(pos) {
    return this.wrap(pos, this.minPycor - 0.5, this.maxPycor + 0.5);
  };

  Torus.prototype.getNeighbors = function(pxcor, pycor) {
    return new Agents(this._getNeighbors(pxcor, pycor));
  };

  Torus.prototype._getNeighbors = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor && pxcor === this.minPxcor) {
      if ((pycor === this.maxPycor && pycor === this.minPycor)([])) {

      } else {
        return [this.getPatchNorth(pxcor, pycor), this.getPatchSouth(pxcor, pycor)];
      }
    } else if (pycor === this.maxPycor && pycor === this.minPycor) {
      return [this.getPatchEast(pxcor, pycor), this.getPatchWest(pxcor, pycor)];
    } else {
      return [this.getPatchNorth(pxcor, pycor), this.getPatchEast(pxcor, pycor), this.getPatchSouth(pxcor, pycor), this.getPatchWest(pxcor, pycor), this.getPatchNorthEast(pxcor, pycor), this.getPatchSouthEast(pxcor, pycor), this.getPatchSouthWest(pxcor, pycor), this.getPatchNorthWest(pxcor, pycor)];
    }
  };

  Torus.prototype.getNeighbors4 = function(pxcor, pycor) {
    return new Agents(this._getNeighbors4(pxcor, pycor));
  };

  Torus.prototype._getNeighbors4 = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor && pxcor === this.minPxcor) {
      if ((pycor === this.maxPycor && pycor === this.minPycor)([])) {

      } else {
        return [this.getPatchNorth(pxcor, pycor), this.getPatchSouth(pxcor, pycor)];
      }
    } else if (pycor === this.maxPycor && pycor === this.minPycor) {
      return [this.getPatchEast(pxcor, pycor), this.getPatchWest(pxcor, pycor)];
    } else {
      return [this.getPatchNorth(pxcor, pycor), this.getPatchEast(pxcor, pycor), this.getPatchSouth(pxcor, pycor), this.getPatchWest(pxcor, pycor)];
    }
  };

  Torus.prototype.getPatchNorth = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      return world.getPatchAt(pxcor, this.minPycor);
    } else {
      return world.getPatchAt(pxcor, pycor + 1);
    }
  };

  Torus.prototype.getPatchSouth = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      return world.getPatchAt(pxcor, this.maxPycor);
    } else {
      return world.getPatchAt(pxcor, pycor - 1);
    }
  };

  Torus.prototype.getPatchEast = function(pxcor, pycor) {
    if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor);
    } else {
      return world.getPatchAt(pxcor + 1, pycor);
    }
  };

  Torus.prototype.getPatchWest = function(pxcor, pycor) {
    if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor);
    } else {
      return world.getPatchAt(pxcor - 1, pycor);
    }
  };

  Torus.prototype.getPatchNorthWest = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      if (pxcor === this.minPxcor) {
        return world.getPatchAt(this.maxPxcor, this.minPycor);
      } else {
        return world.getPatchAt(pxcor - 1, this.minPycor);
      }
    } else if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor + 1);
    } else {
      return world.getPatchAt(pxcor - 1, pycor + 1);
    }
  };

  Torus.prototype.getPatchSouthWest = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      if (pxcor === this.minPxcor) {
        return world.getPatchAt(this.maxPxcor, this.maxPycor);
      } else {
        return world.getPatchAt(pxcor - 1, this.maxPycor);
      }
    } else if (pxcor === this.minPxcor) {
      return world.getPatchAt(this.maxPxcor, pycor - 1);
    } else {
      return world.getPatchAt(pxcor - 1, pycor - 1);
    }
  };

  Torus.prototype.getPatchSouthEast = function(pxcor, pycor) {
    if (pycor === this.minPycor) {
      if (pxcor === this.maxPxcor) {
        return world.getPatchAt(this.minPxcor, this.maxPycor);
      } else {
        return world.getPatchAt(pxcor + 1, this.maxPycor);
      }
    } else if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor - 1);
    } else {
      return world.getPatchAt(pxcor + 1, pycor - 1);
    }
  };

  Torus.prototype.getPatchNorthEast = function(pxcor, pycor) {
    if (pycor === this.maxPycor) {
      if (pxcor === this.maxPxcor) {
        return world.getPatchAt(this.minPxcor, this.minPycor);
      } else {
        return world.getPatchAt(pxcor + 1, this.minPycor);
      }
    } else if (pxcor === this.maxPxcor) {
      return world.getPatchAt(this.minPxcor, pycor + 1);
    } else {
      return world.getPatchAt(pxcor + 1, pycor + 1);
    }
  };

  return Torus;

})();

VertCylinder = (function() {

  function VertCylinder(minPxcor, maxPxcor, minPycor, maxPycor) {
    this.minPxcor = minPxcor;
    this.maxPxcor = maxPxcor;
    this.minPycor = minPycor;
    this.maxPycor = maxPycor;
  }

  VertCylinder.prototype.wrap = function(pos, min, max) {
    var result;
    if (pos >= max) {
      return min + ((pos - max) % (max - min));
    } else if (pos < min) {
      result = max - ((min - pos) % (max - min));
      if (result < max) {
        return result;
      } else {
        return min;
      }
    } else {
      return pos;
    }
  };

  VertCylinder.prototype.wrapX = function(pos) {
    return this.wrap(pos, this.minPxcor - 0.5, this.maxPxcor + 0.5);
  };

  VertCylinder.prototype.wrapY = function(pos) {
    if (pos >= this.maxPycor + 0.5 || pos <= this.minPycor - 0.5) {
      throw new Error("Cannot move turtle beyond the world's edge.");
    } else {
      return pos;
    }
  };

  return VertCylinder;

})();
;
(function() {

  window.AgentModel = (function() {
    var mergeObjectInto;

    function AgentModel() {
      this.turtles = {};
      this.patches = {};
      this.links = {};
      this.observer = {};
      this.world = {};
    }

    AgentModel.prototype.update = function(modelUpdate) {
      var anyUpdates, l, linkId, p, patchId, t, turtleId, varUpdates, worldUpdate, _ref, _ref1, _ref2;
      anyUpdates = false;
      _ref = modelUpdate.turtles;
      for (turtleId in _ref) {
        varUpdates = _ref[turtleId];
        anyUpdates = true;
        if (varUpdates === null || varUpdates['WHO'] === -1) {
          delete this.turtles[turtleId];
        } else {
          t = this.turtles[turtleId];
          if (!(t != null)) {
            t = this.turtles[turtleId] = {
              heading: 360 * Math.random(),
              xcor: 0,
              ycor: 0,
              shape: 'default',
              color: 'hsl(' + (360 * Math.random()) + ',100%,50%)'
            };
          }
          mergeObjectInto(varUpdates, t);
        }
      }
      _ref1 = modelUpdate.links;
      for (linkId in _ref1) {
        varUpdates = _ref1[linkId];
        anyUpdates = true;
        if (varUpdates === null) {
          delete this.links[linkId];
        } else {
          l = this.links[linkId];
          if (!(l != null)) {
            l = this.links[linkId] = {
              shape: 'default',
              color: 5
            };
          }
          mergeObjectInto(varUpdates, l);
        }
      }
      if ((modelUpdate.world != null) && (modelUpdate.world[0] != null)) {
        worldUpdate = modelUpdate.world[0];
        mergeObjectInto(modelUpdate.world[0], this.world);
        if ((worldUpdate.worldWidth != null) && (worldUpdate.worldHeight != null)) {
          this.patches = {};
        }
      }
      _ref2 = modelUpdate.patches;
      for (patchId in _ref2) {
        varUpdates = _ref2[patchId];
        anyUpdates = true;
        p = this.patches[patchId];
        if (p == null) {
          p = this.patches[patchId] = {};
        }
        mergeObjectInto(varUpdates, p);
      }
      mergeObjectInto(modelUpdate.observer, this.observer);
      return anyUpdates;
    };

    mergeObjectInto = function(updatedObject, targetObject) {
      var value, variable;
      for (variable in updatedObject) {
        value = updatedObject[variable];
        targetObject[variable.toLowerCase()] = value;
      }
    };

    return AgentModel;

  })();

}).call(this);
;
(function() {
  var b, baseIndex, cachedNetlogoColors, colorArrayToCSS, colorTimesTen, g, netlogoBaseColors, r, step;

  window.netlogoColorToCSS = function(netlogoColor) {
    switch (typeof netlogoColor) {
      case "number":
        return cachedNetlogoColors[Math.floor(netlogoColor * 10)];
      case "object":
        return colorArrayToCSS(netlogoColor);
      case "string":
        return netlogoColor;
      default:
        return console.error("Unrecognized color: " + netlogoColor);
    }
  };

  netlogoBaseColors = [[140, 140, 140], [215, 48, 39], [241, 105, 19], [156, 109, 70], [237, 237, 47], [87, 176, 58], [42, 209, 57], [27, 158, 119], [82, 196, 196], [43, 140, 190], [50, 92, 168], [123, 78, 163], [166, 25, 105], [224, 126, 149], [0, 0, 0], [255, 255, 255]];

  cachedNetlogoColors = (function() {
    var _i, _ref, _results;
    _results = [];
    for (colorTimesTen = _i = 0; _i <= 1400; colorTimesTen = ++_i) {
      baseIndex = Math.floor(colorTimesTen / 100);
      _ref = netlogoBaseColors[baseIndex], r = _ref[0], g = _ref[1], b = _ref[2];
      step = (colorTimesTen % 100 - 50) / 50.48 + 0.012;
      if (step < 0) {
        r += Math.floor(r * step);
        g += Math.floor(g * step);
        b += Math.floor(b * step);
      } else {
        r += Math.floor((0xFF - r) * step);
        g += Math.floor((0xFF - g) * step);
        b += Math.floor((0xFF - b) * step);
      }
      _results.push("rgb(" + r + ", " + g + ", " + b + ")");
    }
    return _results;
  })();

  colorArrayToCSS = function(array) {
    var a, _ref;
    _ref = array.map(Math.round), r = _ref[0], g = _ref[1], b = _ref[2];
    a = array.length > 3 ? array[3] : 255;
    if (a < 255) {
      return "rgba(" + r + ", " + g + ", " + b + ", " + (a / 255) + ")";
    } else {
      return "rgb(" + r + ", " + g + ", " + b + ")";
    }
  };

}).call(this);
;
(function() {
  var drawPath, setColoring,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  window.ShapeDrawer = (function() {

    function ShapeDrawer(shapes) {
      this.shapes = shapes;
    }

    ShapeDrawer.prototype.drawShape = function(ctx, turtleColor, shapeName) {
      ctx.translate(.5, -.5);
      ctx.scale(-1 / 300, 1 / 300);
      this.drawRawShape(ctx, turtleColor, shapeName);
    };

    ShapeDrawer.prototype.drawRawShape = function(ctx, turtleColor, shapeName) {
      var elem, shape, _i, _len, _ref;
      shape = this.shapes[shapeName] || defaultShape;
      _ref = shape.elements;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        elem = _ref[_i];
        draw[elem.type](ctx, turtleColor, elem);
      }
    };

    return ShapeDrawer;

  })();

  window.CachingShapeDrawer = (function(_super) {

    __extends(CachingShapeDrawer, _super);

    function CachingShapeDrawer(shapes) {
      CachingShapeDrawer.__super__.constructor.call(this, shapes);
      this.shapeCache = {};
    }

    CachingShapeDrawer.prototype.drawShape = function(ctx, turtleColor, shapeName) {
      var shapeCanvas, shapeCtx, shapeKey;
      shapeName = shapeName.toLowerCase();
      shapeKey = this.shapeKey(shapeName, turtleColor);
      shapeCanvas = this.shapeCache[shapeKey];
      if (!(shapeCanvas != null)) {
        shapeCanvas = document.createElement('canvas');
        shapeCanvas.width = shapeCanvas.height = 300;
        shapeCtx = shapeCanvas.getContext('2d');
        this.drawRawShape(shapeCtx, turtleColor, shapeName);
        this.shapeCache[shapeKey] = shapeCanvas;
      }
      ctx.translate(.5, -.5);
      ctx.scale(-1 / 300, 1 / 300);
      ctx.drawImage(shapeCanvas, 0, 0);
    };

    CachingShapeDrawer.prototype.shapeKey = function(shapeName, turtleColor) {
      return [shapeName, netlogoColorToCSS(turtleColor)];
    };

    return CachingShapeDrawer;

  })(ShapeDrawer);

  setColoring = function(ctx, turtleColor, element) {
    turtleColor = netlogoColorToCSS(turtleColor);
    if (element.filled) {
      if (element.marked) {
        ctx.fillStyle = turtleColor;
      } else {
        ctx.fillStyle = element.color;
      }
    } else {
      if (element.marked) {
        ctx.strokeStyle = turtleColor;
      } else {
        ctx.strokeStyle = element.color;
      }
    }
  };

  drawPath = function(ctx, turtleColor, element) {
    setColoring(ctx, turtleColor, element);
    if (element.filled) {
      ctx.fill();
    } else {
      ctx.stroke();
    }
  };

  window.draw = {
    circle: function(ctx, turtleColor, circle) {
      var r;
      r = circle.diam / 2;
      ctx.beginPath();
      ctx.arc(circle.x + r, circle.y + r, r, 0, 2 * Math.PI, false);
      ctx.closePath();
      drawPath(ctx, turtleColor, circle);
    },
    polygon: function(ctx, turtleColor, polygon) {
      var i, x, xcors, y, ycors, _i, _len, _ref;
      xcors = polygon.xcors;
      ycors = polygon.ycors;
      ctx.beginPath();
      ctx.moveTo(xcors[0], ycors[0]);
      _ref = xcors.slice(1);
      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {
        x = _ref[i];
        y = ycors[i + 1];
        ctx.lineTo(x, y);
      }
      ctx.closePath();
      drawPath(ctx, turtleColor, polygon);
    },
    rectangle: function(ctx, turtleColor, rectangle) {
      var h, w, x, y;
      x = rectangle.xmin;
      y = rectangle.ymin;
      w = rectangle.xmax - x;
      h = rectangle.ymax - y;
      setColoring(ctx, turtleColor, rectangle);
      if (rectangle.filled) {
        ctx.fillRect(x, y, w, h);
      } else {
        ctx.strokeRect(x, y, w, h);
      }
    },
    line: function(ctx, turtleColor, line) {
      var h, w, x, y;
      x = line.x1;
      y = line.y1;
      w = line.x2 - line.x1;
      h = line.y2 - line.y1;
      setColoring(ctx, turtleColor, line);
      ctx.lineWidth = 15;
      ctx.beginPath();
      ctx.moveTo(line.x1, line.y1);
      ctx.lineTo(line.x2, line.y2);
      ctx.stroke();
      ctx.lineWidth = .1;
    }
  };

  window.defaultShape = {
    rotate: true,
    elements: [
      {
        type: 'polygon',
        color: 'grey',
        filled: 'true',
        marked: 'true',
        xcors: [150, 40, 150, 260],
        ycors: [5, 250, 205, 250]
      }
    ]
  };

}).call(this);
;
defaultShapes = {
  "default": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          40,
          150,
          260
        ],
        "ycors": [
          5,
          250,
          205,
          250
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "airplane": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          135,
          120,
          120,
          15,
          15,
          120,
          135,
          105,
          120,
          150,
          180,
          210,
          165,
          180,
          285,
          285,
          180,
          180,
          165
        ],
        "ycors": [
          0,
          15,
          60,
          105,
          165,
          195,
          180,
          240,
          270,
          285,
          270,
          285,
          270,
          240,
          180,
          195,
          165,
          105,
          60,
          15
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "arrow": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          0,
          105,
          105,
          195,
          195,
          300
        ],
        "ycors": [
          0,
          150,
          150,
          293,
          293,
          150,
          150
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "box": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          285,
          285,
          150
        ],
        "ycors": [
          285,
          225,
          75,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          150,
          15,
          150,
          285
        ],
        "ycors": [
          135,
          75,
          15,
          75
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          15,
          15,
          150,
          150
        ],
        "ycors": [
          75,
          225,
          285,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 285,
        "x2": 150,
        "y2": 135,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 135,
        "x2": 15,
        "y2": 75,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 135,
        "x2": 285,
        "y2": 75,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "bug": {
    "rotate": true,
    "elements": [
      {
        "x": 96,
        "y": 182,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 110,
        "y": 127,
        "diam": 80,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 110,
        "y": 75,
        "diam": 80,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 100,
        "x2": 80,
        "y2": 30,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 100,
        "x2": 220,
        "y2": 30,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "butterfly": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          150,
          209,
          225,
          225,
          195,
          165,
          150
        ],
        "ycors": [
          165,
          199,
          225,
          255,
          270,
          255,
          240
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          150,
          89,
          75,
          75,
          105,
          135,
          150
        ],
        "ycors": [
          165,
          198,
          225,
          255,
          270,
          255,
          240
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          139,
          100,
          55,
          25,
          10,
          10,
          25,
          40,
          85,
          139
        ],
        "ycors": [
          148,
          105,
          90,
          90,
          105,
          135,
          180,
          195,
          194,
          163
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          162,
          200,
          245,
          275,
          290,
          290,
          275,
          260,
          215,
          162
        ],
        "ycors": [
          150,
          105,
          90,
          90,
          105,
          135,
          180,
          195,
          195,
          165
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          150,
          135,
          120,
          135,
          150,
          165,
          180,
          165
        ],
        "ycors": [
          255,
          225,
          150,
          120,
          105,
          120,
          150,
          225
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 135,
        "y": 90,
        "diam": 30,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 105,
        "x2": 195,
        "y2": 60,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 105,
        "x2": 105,
        "y2": 60,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "car": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          300,
          279,
          261,
          240,
          226,
          213,
          203,
          185,
          159,
          135,
          75,
          0,
          0,
          0,
          300,
          300
        ],
        "ycors": [
          180,
          164,
          144,
          135,
          132,
          106,
          84,
          63,
          50,
          50,
          60,
          150,
          165,
          225,
          225,
          180
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 180,
        "y": 180,
        "diam": 90,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 30,
        "y": 180,
        "diam": 90,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          162,
          132,
          134,
          209,
          194,
          189,
          180
        ],
        "ycors": [
          80,
          78,
          135,
          135,
          105,
          96,
          89
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 47,
        "y": 195,
        "diam": 58,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 195,
        "y": 195,
        "diam": 58,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "circle": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "circle 2": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 30,
        "y": 30,
        "diam": 240,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "cloud": {
    "rotate": false,
    "elements": [
      {
        "x": 13,
        "y": 118,
        "diam": 94,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 86,
        "y": 101,
        "diam": 127,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 51,
        "y": 51,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 118,
        "y": 43,
        "diam": 95,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 158,
        "y": 68,
        "diam": 134,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "co2-molecule": {
    "rotate": true,
    "elements": [
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "cow": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          200,
          197,
          179,
          177,
          166,
          140,
          93,
          78,
          72,
          49,
          48,
          37,
          25,
          25,
          45,
          103,
          179,
          198,
          252,
          272,
          293,
          285,
          255,
          242,
          224
        ],
        "ycors": [
          193,
          249,
          249,
          196,
          187,
          189,
          191,
          179,
          211,
          209,
          181,
          149,
          120,
          89,
          72,
          84,
          75,
          76,
          64,
          81,
          103,
          121,
          121,
          118,
          167
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          73,
          86,
          62,
          48
        ],
        "ycors": [
          210,
          251,
          249,
          208
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          25,
          16,
          9,
          23,
          25,
          39
        ],
        "ycors": [
          114,
          195,
          204,
          213,
          200,
          123
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "cylinder": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "dot": {
    "rotate": false,
    "elements": [
      {
        "x": 90,
        "y": 90,
        "diam": 120,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "face happy": {
    "rotate": false,
    "elements": [
      {
        "x": 8,
        "y": 8,
        "diam": 285,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 60,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 180,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          150,
          90,
          62,
          47,
          67,
          90,
          109,
          150,
          192,
          210,
          227,
          251,
          236,
          212
        ],
        "ycors": [
          255,
          239,
          213,
          191,
          179,
          203,
          218,
          225,
          218,
          203,
          181,
          194,
          217,
          240
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "face neutral": {
    "rotate": false,
    "elements": [
      {
        "x": 8,
        "y": 7,
        "diam": 285,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 60,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 180,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xmin": 60,
        "ymin": 195,
        "xmax": 240,
        "ymax": 225,
        "type": "rectangle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "face sad": {
    "rotate": false,
    "elements": [
      {
        "x": 8,
        "y": 8,
        "diam": 285,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 60,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 180,
        "y": 75,
        "diam": 60,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          150,
          90,
          62,
          47,
          67,
          90,
          109,
          150,
          192,
          210,
          227,
          251,
          236,
          212
        ],
        "ycors": [
          168,
          184,
          210,
          232,
          244,
          220,
          205,
          198,
          205,
          220,
          242,
          229,
          206,
          183
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "fish": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          44,
          21,
          15,
          0,
          15,
          0,
          13,
          20,
          45
        ],
        "ycors": [
          131,
          87,
          86,
          120,
          150,
          180,
          214,
          212,
          166
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          135,
          119,
          95,
          76,
          46,
          60
        ],
        "ycors": [
          195,
          235,
          218,
          210,
          204,
          165
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          75,
          83,
          71,
          86,
          166,
          135
        ],
        "ycors": [
          45,
          77,
          103,
          114,
          78,
          60
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          30,
          151,
          226,
          280,
          292,
          292,
          287,
          270,
          195,
          151,
          30
        ],
        "ycors": [
          136,
          77,
          81,
          119,
          146,
          160,
          170,
          195,
          210,
          212,
          166
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 215,
        "y": 106,
        "diam": 30,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "flag": {
    "rotate": false,
    "elements": [
      {
        "xmin": 60,
        "ymin": 15,
        "xmax": 75,
        "ymax": 300,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          90,
          270,
          90
        ],
        "ycors": [
          150,
          90,
          30
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 75,
        "y1": 135,
        "x2": 90,
        "y2": 135,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 75,
        "y1": 45,
        "x2": 90,
        "y2": 45,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "flower": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          135,
          165,
          180,
          180,
          150,
          165,
          195,
          195,
          165
        ],
        "ycors": [
          120,
          165,
          210,
          240,
          300,
          300,
          240,
          195,
          135
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 85,
        "y": 132,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 130,
        "y": 147,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 192,
        "y": 85,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 85,
        "y": 40,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 177,
        "y": 40,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 177,
        "y": 132,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 70,
        "y": 85,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 130,
        "y": 25,
        "diam": 38,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 96,
        "y": 51,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 113,
        "y": 68,
        "diam": 74,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          189,
          219,
          249,
          279,
          234
        ],
        "ycors": [
          233,
          188,
          173,
          188,
          218
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          180,
          150,
          105,
          75,
          135
        ],
        "ycors": [
          255,
          210,
          210,
          240,
          240
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "house": {
    "rotate": false,
    "elements": [
      {
        "xmin": 45,
        "ymin": 120,
        "xmax": 255,
        "ymax": 285,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 120,
        "ymin": 210,
        "xmax": 180,
        "ymax": 285,
        "type": "rectangle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          15,
          150,
          285
        ],
        "ycors": [
          120,
          15,
          120
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 30,
        "y1": 120,
        "x2": 270,
        "y2": 120,
        "type": "line",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "leaf": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          135,
          120,
          60,
          30,
          60,
          60,
          15,
          30,
          15,
          40,
          45,
          60,
          90,
          105,
          120,
          105,
          120,
          135,
          150,
          165,
          180,
          195,
          180,
          195,
          210,
          240,
          255,
          263,
          285,
          270,
          285,
          240,
          240,
          270,
          240,
          180,
          165
        ],
        "ycors": [
          210,
          195,
          210,
          210,
          195,
          180,
          165,
          135,
          120,
          105,
          104,
          90,
          90,
          105,
          120,
          120,
          60,
          60,
          30,
          15,
          30,
          60,
          60,
          120,
          120,
          105,
          90,
          90,
          104,
          105,
          120,
          135,
          165,
          180,
          195,
          210,
          210,
          195
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          135,
          120,
          105,
          105,
          135,
          165,
          165
        ],
        "ycors": [
          195,
          240,
          255,
          255,
          285,
          285,
          240,
          195
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "line": {
    "rotate": true,
    "elements": [
      {
        "x1": 150,
        "y1": 0,
        "x2": 150,
        "y2": 300,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "line half": {
    "rotate": true,
    "elements": [
      {
        "x1": 150,
        "y1": 0,
        "x2": 150,
        "y2": 150,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "molecule water": {
    "rotate": true,
    "elements": [
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 183,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 75,
        "y": 75,
        "diam": 150,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 33,
        "y": 63,
        "diam": 84,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": false,
        "marked": false
      }
    ]
  },
  "pentagon": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          15,
          60,
          240,
          285
        ],
        "ycors": [
          15,
          120,
          285,
          285,
          120
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "person": {
    "rotate": false,
    "elements": [
      {
        "x": 110,
        "y": 5,
        "diam": 80,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          105,
          120,
          90,
          105,
          135,
          150,
          165,
          195,
          210,
          180,
          195
        ],
        "ycors": [
          90,
          195,
          285,
          300,
          300,
          225,
          300,
          300,
          285,
          195,
          90
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 127,
        "ymin": 79,
        "xmax": 172,
        "ymax": 94,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          195,
          240,
          225,
          165
        ],
        "ycors": [
          90,
          150,
          180,
          105
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          105,
          60,
          75,
          135
        ],
        "ycors": [
          90,
          150,
          180,
          105
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "plant": {
    "rotate": false,
    "elements": [
      {
        "xmin": 135,
        "ymin": 90,
        "xmax": 165,
        "ymax": 300,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          90,
          45,
          75,
          135
        ],
        "ycors": [
          255,
          210,
          195,
          255,
          285
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          165,
          210,
          255,
          225,
          165
        ],
        "ycors": [
          255,
          210,
          195,
          255,
          285
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          90,
          45,
          75,
          135
        ],
        "ycors": [
          180,
          135,
          120,
          180,
          210
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          165,
          165,
          225,
          255,
          210
        ],
        "ycors": [
          180,
          210,
          180,
          120,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          90,
          45,
          75,
          135
        ],
        "ycors": [
          105,
          60,
          45,
          105,
          135
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          165,
          165,
          225,
          255,
          210
        ],
        "ycors": [
          105,
          135,
          105,
          45,
          60
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          135,
          120,
          150,
          180,
          165
        ],
        "ycors": [
          90,
          45,
          15,
          45,
          90
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "ray": {
    "rotate": true,
    "elements": [
      {
        "x1": 150,
        "y1": 0,
        "x2": 150,
        "y2": 315,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 120,
        "y1": 255,
        "x2": 150,
        "y2": 225,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 225,
        "x2": 180,
        "y2": 255,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 120,
        "y1": 165,
        "x2": 150,
        "y2": 135,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 120,
        "y1": 75,
        "x2": 150,
        "y2": 45,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 135,
        "x2": 180,
        "y2": 165,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 150,
        "y1": 45,
        "x2": 180,
        "y2": 75,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "sheep": {
    "rotate": false,
    "elements": [
      {
        "x": 203,
        "y": 65,
        "diam": 88,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 70,
        "y": 65,
        "diam": 162,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 150,
        "y": 105,
        "diam": 120,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          218,
          240,
          255,
          278
        ],
        "ycors": [
          120,
          165,
          165,
          120
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 214,
        "y": 72,
        "diam": 67,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xmin": 164,
        "ymin": 223,
        "xmax": 179,
        "ymax": 298,
        "type": "rectangle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          45,
          30,
          30,
          15,
          45
        ],
        "ycors": [
          285,
          285,
          240,
          195,
          210
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 3,
        "y": 83,
        "diam": 150,
        "type": "circle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 65,
        "ymin": 221,
        "xmax": 80,
        "ymax": 296,
        "type": "rectangle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          195,
          210,
          210,
          240,
          195
        ],
        "ycors": [
          285,
          285,
          240,
          210,
          210
        ],
        "type": "polygon",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          276,
          285,
          302,
          294
        ],
        "ycors": [
          85,
          105,
          99,
          83
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          219,
          210,
          193,
          201
        ],
        "ycors": [
          85,
          105,
          99,
          83
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "square": {
    "rotate": false,
    "elements": [
      {
        "xmin": 30,
        "ymin": 30,
        "xmax": 270,
        "ymax": 270,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "square 2": {
    "rotate": false,
    "elements": [
      {
        "xmin": 30,
        "ymin": 30,
        "xmax": 270,
        "ymax": 270,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 60,
        "ymin": 60,
        "xmax": 240,
        "ymax": 240,
        "type": "rectangle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "star": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          151,
          185,
          298,
          207,
          242,
          151,
          59,
          94,
          3,
          116
        ],
        "ycors": [
          1,
          108,
          108,
          175,
          282,
          216,
          282,
          175,
          108,
          108
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "target": {
    "rotate": false,
    "elements": [
      {
        "x": 0,
        "y": 0,
        "diam": 300,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 30,
        "y": 30,
        "diam": 240,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 60,
        "y": 60,
        "diam": 180,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 90,
        "y": 90,
        "diam": 120,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 120,
        "y": 120,
        "diam": 60,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "tree": {
    "rotate": false,
    "elements": [
      {
        "x": 118,
        "y": 3,
        "diam": 94,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 120,
        "ymin": 195,
        "xmax": 180,
        "ymax": 300,
        "type": "rectangle",
        "color": "rgba(157, 110, 72, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 65,
        "y": 21,
        "diam": 108,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 116,
        "y": 41,
        "diam": 127,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 45,
        "y": 90,
        "diam": 120,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 104,
        "y": 74,
        "diam": 152,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "triangle": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          15,
          285
        ],
        "ycors": [
          30,
          255,
          255
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "triangle 2": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          150,
          15,
          285
        ],
        "ycors": [
          30,
          255,
          255
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          151,
          225,
          75
        ],
        "ycors": [
          99,
          223,
          224
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      }
    ]
  },
  "truck": {
    "rotate": false,
    "elements": [
      {
        "xmin": 4,
        "ymin": 45,
        "xmax": 195,
        "ymax": 187,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          296,
          296,
          259,
          244,
          208,
          207
        ],
        "ycors": [
          193,
          150,
          134,
          104,
          104,
          194
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xmin": 195,
        "ymin": 60,
        "xmax": 195,
        "ymax": 105,
        "type": "rectangle",
        "color": "rgba(255, 255, 255, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          238,
          252,
          219,
          218
        ],
        "ycors": [
          112,
          141,
          141,
          112
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 234,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xmin": 181,
        "ymin": 185,
        "xmax": 214,
        "ymax": 194,
        "type": "rectangle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 144,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 24,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x": 24,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x": 144,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x": 234,
        "y": 174,
        "diam": 42,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "turtle": {
    "rotate": true,
    "elements": [
      {
        "xcors": [
          215,
          240,
          246,
          228,
          215,
          193
        ],
        "ycors": [
          204,
          233,
          254,
          266,
          252,
          210
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          195,
          225,
          245,
          260,
          269,
          261,
          240,
          225,
          210
        ],
        "ycors": [
          90,
          75,
          75,
          89,
          108,
          124,
          105,
          105,
          105
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          105,
          75,
          55,
          40,
          31,
          39,
          60,
          75,
          90
        ],
        "ycors": [
          90,
          75,
          75,
          89,
          108,
          124,
          105,
          105,
          105
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          132,
          134,
          107,
          108,
          150,
          192,
          192,
          169,
          172
        ],
        "ycors": [
          85,
          64,
          51,
          17,
          2,
          18,
          52,
          65,
          87
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          85,
          60,
          54,
          72,
          85,
          107
        ],
        "ycors": [
          204,
          233,
          254,
          266,
          252,
          210
        ],
        "type": "polygon",
        "color": "rgba(89, 176, 60, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          119,
          179,
          209,
          224,
          220,
          175,
          128,
          81,
          74,
          88
        ],
        "ycors": [
          75,
          75,
          101,
          135,
          225,
          261,
          261,
          224,
          135,
          99
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "wheel": {
    "rotate": false,
    "elements": [
      {
        "x": 3,
        "y": 3,
        "diam": 294,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x": 30,
        "y": 30,
        "diam": 240,
        "type": "circle",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "x1": 150,
        "y1": 285,
        "x2": 150,
        "y2": 15,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 15,
        "y1": 150,
        "x2": 285,
        "y2": 150,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x": 120,
        "y": 120,
        "diam": 60,
        "type": "circle",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "x1": 216,
        "y1": 40,
        "x2": 79,
        "y2": 269,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 40,
        "y1": 84,
        "x2": 269,
        "y2": 221,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 40,
        "y1": 216,
        "x2": 269,
        "y2": 79,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      },
      {
        "x1": 84,
        "y1": 40,
        "x2": 221,
        "y2": 269,
        "type": "line",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": false,
        "marked": true
      }
    ]
  },
  "wolf": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          253,
          245,
          245
        ],
        "ycors": [
          133,
          131,
          133
        ],
        "type": "polygon",
        "color": "rgba(0, 0, 0, 1.0)",
        "filled": true,
        "marked": false
      },
      {
        "xcors": [
          2,
          13,
          30,
          38,
          38,
          20,
          20,
          27,
          38,
          40,
          31,
          31,
          60,
          68,
          75,
          66,
          65,
          82,
          84,
          100,
          103,
          77,
          79,
          100,
          98,
          119,
          143,
          160,
          166,
          172,
          173,
          167,
          160,
          154,
          169,
          178,
          186,
          198,
          200,
          217,
          219,
          207,
          195,
          192,
          210,
          227,
          242,
          259,
          284,
          277,
          293,
          299,
          297,
          273,
          270
        ],
        "ycors": [
          194,
          197,
          191,
          193,
          205,
          226,
          257,
          265,
          266,
          260,
          253,
          230,
          206,
          198,
          209,
          228,
          243,
          261,
          268,
          267,
          261,
          239,
          231,
          207,
          196,
          201,
          202,
          195,
          210,
          213,
          238,
          251,
          248,
          265,
          264,
          247,
          240,
          260,
          271,
          271,
          262,
          258,
          230,
          198,
          184,
          164,
          144,
          145,
          151,
          141,
          140,
          134,
          127,
          119,
          105
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          -1,
          14,
          36,
          40,
          53,
          82,
          134,
          159,
          188,
          227,
          236,
          238,
          268,
          269,
          281,
          269,
          269
        ],
        "ycors": [
          195,
          180,
          166,
          153,
          140,
          131,
          133,
          126,
          115,
          108,
          102,
          98,
          86,
          92,
          87,
          103,
          113
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  },
  "x": {
    "rotate": false,
    "elements": [
      {
        "xcors": [
          270,
          225,
          30,
          75
        ],
        "ycors": [
          75,
          30,
          225,
          270
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      },
      {
        "xcors": [
          30,
          75,
          270,
          225
        ],
        "ycors": [
          75,
          30,
          225,
          270
        ],
        "type": "polygon",
        "color": "rgba(141, 141, 141, 1.0)",
        "filled": true,
        "marked": true
      }
    ]
  }
}
;
(function() {
  var PatchView, TurtleView, View,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  if (!(window.AgentModel != null)) {
    console.error('view.js requires agentmodel.js!');
  }

  window.AgentStreamController = (function() {

    function AgentStreamController(container) {
      this.container = container;
      this.layers = document.createElement('div');
      this.layers.style.width = '100%';
      this.layers.style.position = 'relative';
      this.layers.classList.add('view-layers');
      this.container.appendChild(this.layers);
      this.turtleView = new TurtleView();
      this.patchView = new PatchView();
      this.turtleView.canvas.style.position = 'absolute';
      this.turtleView.canvas.style.top = '0px';
      this.turtleView.canvas.style.left = '0px';
      this.layers.appendChild(this.patchView.canvas);
      this.layers.appendChild(this.turtleView.canvas);
      this.model = new AgentModel();
      this.model.world.turtleshapelist = defaultShapes;
      this.repaint();
    }

    AgentStreamController.prototype.repaint = function() {
      this.turtleView.repaint(this.model.world, this.model.turtles, this.model.links);
      return this.patchView.repaint(this.model.world, this.model.patches);
    };

    AgentStreamController.prototype.update = function(modelUpdate) {
      return this.model.update(modelUpdate);
    };

    return AgentStreamController;

  })();

  View = (function() {

    function View() {
      this.quality = 1;
      this.canvas = document.createElement('canvas');
      this.canvas["class"] = 'netlogo-canvas';
      this.canvas.width = 500;
      this.canvas.height = 500;
      this.canvas.style.width = "100%";
      this.ctx = this.canvas.getContext('2d');
    }

    View.prototype.matchesWorld = function(world) {
      return ((this.maxpxcor != null) && (this.minpxcor != null) && (this.maxpycor != null) && (this.minpycor != null) && (this.patchsize != null)) && (!(world.maxpxcor != null) || world.maxpxcor === this.maxpxcor) && (!(world.minpxcor != null) || world.minpxcor === this.minpxcor) && (!(world.maxpycor != null) || world.maxpycor === this.maxpycor) && (!(world.minpycor != null) || world.minpycor === this.minpycor) && (!(world.patchsize != null) || world.patchsize === this.patchsize);
    };

    View.prototype.transformToWorld = function(world) {
      this.maxpxcor = world.maxpxcor != null ? world.maxpxcor : 25;
      this.minpxcor = world.minpxcor != null ? world.minpxcor : -25;
      this.maxpycor = world.maxpycor != null ? world.maxpycor : 25;
      this.minpycor = world.minpycor != null ? world.minpycor : -25;
      this.patchsize = world.patchsize != null ? world.patchsize : 9;
      this.onePixel = 1 / this.patchsize;
      this.patchWidth = this.maxpxcor - this.minpxcor + 1;
      this.patchHeight = this.maxpycor - this.minpycor + 1;
      this.canvas.width = this.patchWidth * this.patchsize * this.quality;
      this.canvas.height = this.patchHeight * this.patchsize * this.quality;
      return this.ctx.setTransform(this.canvas.width / this.patchWidth, 0, 0, -this.canvas.height / this.patchHeight, -(this.minpxcor - .5) * this.canvas.width / this.patchWidth, (this.maxpycor + .5) * this.canvas.height / this.patchHeight);
    };

    return View;

  })();

  TurtleView = (function(_super) {

    __extends(TurtleView, _super);

    function TurtleView() {
      TurtleView.__super__.constructor.call(this);
      this.drawer = new CachingShapeDrawer({});
      this.quality = 3;
    }

    TurtleView.prototype.drawTurtle = function(id, turtle) {
      var angle, heading, scale, shape, shapeName, xcor, ycor;
      xcor = turtle.xcor || 0;
      ycor = turtle.ycor || 0;
      heading = turtle.heading || 0;
      scale = turtle.size || 1;
      angle = (180 - heading) / 360 * 2 * Math.PI;
      shapeName = turtle.shape;
      shape = this.drawer.shapes[shapeName] || defaultShape;
      this.ctx.save();
      this.ctx.translate(xcor, ycor);
      if (shape.rotate) {
        this.ctx.rotate(angle);
      } else {
        this.ctx.rotate(Math.PI);
      }
      this.ctx.scale(scale, scale);
      this.drawer.drawShape(this.ctx, turtle.color, shapeName);
      return this.ctx.restore();
    };

    TurtleView.prototype.drawLink = function(link, turtles) {
      var end1, end2;
      end1 = turtles[link.end1];
      end2 = turtles[link.end2];
      this.ctx.strokeStyle = netlogoColorToCSS(link.color);
      this.ctx.lineWidth = link.thickness > this.onePixel ? link.thickness : this.onePixel;
      this.ctx.beginPath();
      this.ctx.moveTo(end1.xcor, end1.ycor);
      this.ctx.lineTo(end2.xcor, end2.ycor);
      return this.ctx.stroke();
    };

    TurtleView.prototype.repaint = function(world, turtles, links) {
      var id, link, turtle;
      this.transformToWorld(world);
      if (world.turtleshapelist !== this.drawer.shapes && typeof world.turtleshapelist === "object") {
        this.drawer = new CachingShapeDrawer(world.turtleshapelist);
      }
      for (id in links) {
        link = links[id];
        this.drawLink(link, turtles);
      }
      this.ctx.lineWidth = this.onePixel;
      for (id in turtles) {
        turtle = turtles[id];
        this.drawTurtle(id, turtle);
      }
    };

    return TurtleView;

  })(View);

  PatchView = (function(_super) {

    __extends(PatchView, _super);

    function PatchView() {
      PatchView.__super__.constructor.call(this);
      this.patchColors = [];
    }

    PatchView.prototype.transformToWorld = function(world) {
      var col, x, y, _i, _j, _ref, _ref1, _ref2, _ref3;
      PatchView.__super__.transformToWorld.call(this, world);
      this.patchColors = [];
      for (x = _i = _ref = this.minpxcor, _ref1 = this.maxpxcor; _ref <= _ref1 ? _i <= _ref1 : _i >= _ref1; x = _ref <= _ref1 ? ++_i : --_i) {
        for (y = _j = _ref2 = this.maxpycor, _ref3 = this.minpycor; _ref2 <= _ref3 ? _j <= _ref3 : _j >= _ref3; y = _ref2 <= _ref3 ? ++_j : --_j) {
          this.colorPatch({
            'pxcor': x,
            'pycor': y,
            'pcolor': 'black'
          });
        }
        col = 0;
      }
    };

    PatchView.prototype.colorPatch = function(patch) {
      var col, color, patchIndex, row;
      row = this.maxpycor - patch.pycor;
      col = patch.pxcor - this.minpxcor;
      patchIndex = row * this.patchWidth + col;
      color = patch.pcolor;
      color = netlogoColorToCSS(color);
      if (color !== this.patchColors[patchIndex]) {
        this.patchColors[patchIndex] = this.ctx.fillStyle = color;
        return this.ctx.fillRect(patch.pxcor - .5, patch.pycor - .5, 1, 1);
      }
    };

    PatchView.prototype.repaint = function(world, patches) {
      var p, _, _results;
      if (!this.matchesWorld(world)) {
        this.transformToWorld(world);
      }
      _results = [];
      for (_ in patches) {
        p = patches[_];
        _results.push(this.colorPatch(p));
      }
      return _results;
    };

    return PatchView;

  })(View);

}).call(this);
;
(function() {
  var Connection;

  window.connect = function(socketURL) {
    return new Connection(new WebSocket(socketURL));
  };

  Connection = (function() {

    function Connection(socket) {
      var _this = this;
      this.socket = socket;
      this.listeners = {
        'all': []
      };
      this.outbox = [];
      this.socket.onmessage = function(event) {
        return _this.dispatch(JSON.parse(event.data));
      };
      this.socket.onopen = function() {
        var msg, _i, _len, _ref, _results;
        _ref = _this.outbox;
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          msg = _ref[_i];
          _results.push(_this.send(msg));
        }
        return _results;
      };
    }

    Connection.prototype.send = function(message) {
      if (this.socket.readyState === this.socket.OPEN) {
        return this.socket.send(JSON.stringify(message));
      } else {
        return this.outbox.push(message);
      }
    };

    Connection.prototype.dispatch = function(msg) {
      var listener, _i, _j, _len, _len1, _ref, _ref1, _results;
      _ref = this.listeners['all'];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        listener = _ref[_i];
        listener(msg);
      }
      if (!(this.listeners[msg.kind] != null)) {
        this.listeners[msg.kind] = [];
      }
      _ref1 = this.listeners[msg.kind];
      _results = [];
      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
        listener = _ref1[_j];
        _results.push(listener(msg));
      }
      return _results;
    };

    Connection.prototype.on = function(kind, listener) {
      if (!(this.listeners[kind] != null)) {
        this.listeners[kind] = [];
      }
      return this.listeners[kind].push(listener);
    };

    return Connection;

  })();

}).call(this);
;
(function() {

  window.SessionLite = (function() {

    SessionLite.controller = void 0;

    function SessionLite(container) {
      container.innerHTML = "";
      this.controller = new AgentStreamController(container);
    }

    SessionLite.prototype.update = function(modelUpdate) {
      var update, _i, _len;
      if (modelUpdate instanceof Array) {
        for (_i = 0, _len = modelUpdate.length; _i < _len; _i++) {
          update = modelUpdate[_i];
          this.controller.update(update);
        }
      } else {
        this.controller.update(modelUpdate);
      }
      return this.controller.repaint();
    };

    return SessionLite;

  })();

}).call(this);
;
Globals.init(7)
Breeds.add("RAYS", "ray");
Breeds.get("RAYS").vars =[""];
Breeds.add("IRS", "ir");
Breeds.get("IRS").vars =[""];
Breeds.add("HEATS", "heat");
Breeds.get("HEATS").vars =[""];
Breeds.add("CO2S", "co2");
Breeds.get("CO2S").vars =[""];
Breeds.add("CLOUDS", "cloud");
Breeds.get("CLOUDS").vars =["CLOUD-SPEED", "CLOUD-ID"];world = new World(-24, 24, -8, 22, 12.0, true, true, 2);
function SETUP () {
world.clearall()
Breeds.setDefaultShape(world.turtlesOfBreed("RAYS"), "ray")
Breeds.setDefaultShape(world.turtlesOfBreed("IRS"), "ray")
Breeds.setDefaultShape(world.turtlesOfBreed("CLOUDS"), "cloud")
Breeds.setDefaultShape(world.turtlesOfBreed("HEATS"), "dot")
Breeds.setDefaultShape(world.turtlesOfBreed("CO2S"), "CO2-molecule")
SETUP_WORLD()
Globals.setGlobal(4,12)
world.resetTicks()
};
function SETUP_WORLD () {
Globals.setGlobal(2,(world.maxPycor - 5))
Globals.setGlobal(3,0)
SETUP_WORLD_UPDATED()
AgentSet.ask(world.patches(), true, function(){ if ((AgentSet.getPatchVariable(1) > Globals.getGlobal(2))) {
AgentSet.setPatchVariable(2,Prims.scaleColor(9.9, AgentSet.getPatchVariable(1), 22, 15))
}
if (((AgentSet.getPatchVariable(1) <= Globals.getGlobal(2)) && (AgentSet.getPatchVariable(1) > Globals.getGlobal(3)))) {
AgentSet.setPatchVariable(2,Prims.scaleColor(105, AgentSet.getPatchVariable(1), -20, 20))
}
if ((AgentSet.getPatchVariable(1) < Globals.getGlobal(3))) {
AgentSet.setPatchVariable(2,(15 + 3))
}
if ((AgentSet.getPatchVariable(1) === Globals.getGlobal(3))) {
UPDATE_ALBEDO()
} });
};
function SETUP_WORLD_UPDATED () {
Globals.setGlobal(5,1)
Globals.setGlobal(6,0.6)
for(var i = 0; i < (Globals.getGlobal(1) / 25); i++) { ADD_CO2() }
for(var i = 0; i < (Globals.getGlobal(0) / 5); i++) { ADD_CLOUD() }
};
function GO () {
GO_UPDATED()
AgentSet.ask(world.turtlesOfBreed("CLOUDS"), true, function(){ Prims.fd(AgentSet.getBreedVariable("CLOUD-SPEED")) });
RUN_SUNSHINE()
AgentSet.ask(AgentSet.agentFilter(world.patches(), function(){ return (AgentSet.getPatchVariable(1) === Globals.getGlobal(3)) }), true, function(){ UPDATE_ALBEDO() });
RUN_HEAT()
RUN_IR()
RUN_CO2()
world.tick()
};
function UPDATE_ALBEDO () {
AgentSet.setPatchVariable(2,Prims.scaleColor(55, Globals.getGlobal(6), 0, 1))
};
function GO_UPDATED () {
var CLOUD_DIFF = (Globals.getGlobal(0) - (MY_LENGTH(Prims.removeDuplicates(AgentSet.of(world.turtlesOfBreed("CLOUDS"), function(){ return AgentSet.getBreedVariable("CLOUD-ID") }))) * 5));
var CO2_DIFF = (Globals.getGlobal(1) - AgentSet.count(world.turtlesOfBreed("CO2S")));
if ((CO2_DIFF >= 0)) {
for(var i = 0; i < (CO2_DIFF / 25); i++) { ADD_CO2() }
} else {
for(var i = 0; i < StrictMath.abs((CO2_DIFF / 25)); i++) { REMOVE_CO2() }
}
if ((CLOUD_DIFF >= 0)) {
for(var i = 0; i < (CLOUD_DIFF / 5); i++) { ADD_CLOUD() }
} else {
for(var i = 0; i < StrictMath.abs((CLOUD_DIFF / 5)); i++) { REMOVE_CLOUD() }
}
};
function ADD_CLOUD () {
var SKY_HEIGHT = (Globals.getGlobal(2) - Globals.getGlobal(3));
var Y = ((Globals.getGlobal(3) + Prims.randomfloat((SKY_HEIGHT - 4))) + 2);
var SPEED = (Prims.randomfloat(0.1) + 0.01);
var X = Prims.randomxcor();
var ID = 0;
if (AgentSet.any(world.turtlesOfBreed("CLOUDS"))) {
ID = (Prims.max(AgentSet.of(world.turtlesOfBreed("CLOUDS"), function(){ return AgentSet.getBreedVariable("CLOUD-ID") })) + 1);
}
AgentSet.ask(world.createturtles((3 + Random.nextLong(20)), "CLOUDS"), true, function(){ AgentSet.setBreedVariable("CLOUD-SPEED",SPEED)
AgentSet.setBreedVariable("CLOUD-ID",ID)
Prims.setxy(((X + Random.nextLong(9)) - 4), (((Y + 2.5) + Prims.randomfloat(2)) - Prims.randomfloat(2)))
AgentSet.setTurtleVariable(1,9.9)
AgentSet.setTurtleVariable(10,(2 + Random.nextLong(2)))
AgentSet.setTurtleVariable(2,90) });
};
function REMOVE_CLOUD () {
if (AgentSet.any(world.turtlesOfBreed("CLOUDS"))) {
var DOOMED_ID = AgentSet.oneOf(Prims.removeDuplicates(AgentSet.of(world.turtlesOfBreed("CLOUDS"), function(){ return AgentSet.getBreedVariable("CLOUD-ID") })));
AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("CLOUDS"), function(){ return (AgentSet.getBreedVariable("CLOUD-ID") === DOOMED_ID) }), true, function(){ AgentSet.die() });
}
};
function RUN_SUNSHINE () {
AgentSet.ask(world.turtlesOfBreed("RAYS"), true, function(){ if (!(MY_CAN_MOVE_P(0.3))) {
AgentSet.die()
}
Prims.fd(0.3) });
CREATE_SUNSHINE()
REFLECT_RAYS_FROM_CLOUDS()
ENCOUNTER_EARTH()
};
function CREATE_SUNSHINE () {
if (((10 * Globals.getGlobal(5)) > Random.nextLong(50))) {
AgentSet.ask(world.createturtles(1, "RAYS"), true, function(){ AgentSet.setTurtleVariable(2,160)
AgentSet.setTurtleVariable(1,45)
Prims.setxy((Random.nextLong(10) + world.minPxcor), world.maxPycor) });
}
};
function REFLECT_RAYS_FROM_CLOUDS () {
AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("RAYS"), function(){ return AgentSet.any(AgentSet.self().breedHere("CLOUDS")) }), true, function(){ AgentSet.setTurtleVariable(2,(180 - AgentSet.getTurtleVariable(2))) });
};
function ENCOUNTER_EARTH () {
AgentSet.ask(AgentSet.agentFilter(world.turtlesOfBreed("RAYS"), function(){ return (AgentSet.getTurtleVariable(4) <= Globals.getGlobal(3)) }), true, function(){ if (((100 * Globals.getGlobal(6)) > Random.nextLong(100))) {
AgentSet.setTurtleVariable(2,(180 - AgentSet.getTurtleVariable(2)))
} else {
Prims.right((Random.nextLong(45) - Random.nextLong(45)))
AgentSet.setTurtleVariable(1,((15 - 2) + Random.nextLong(4)))
AgentSet.setBreed(world.turtlesOfBreed("HEATS"))
} });
};
function RUN_HEAT () {
Globals.setGlobal(4,((0.99 * Globals.getGlobal(4)) + (0.01 * (12 + (0.1 * AgentSet.count(world.turtlesOfBreed("HEATS")))))))
AgentSet.ask(world.turtlesOfBreed("HEATS"), true, function(){ var DIST = (0.5 * Prims.randomfloat(1));
if (MY_CAN_MOVE_P(DIST)) {
Prims.fd(DIST)
} else {
AgentSet.setTurtleVariable(2,(180 - AgentSet.getTurtleVariable(2)))
}
if ((AgentSet.getTurtleVariable(4) >= Globals.getGlobal(3))) {
if ((((Globals.getGlobal(4) > (20 + Random.nextLong(40))) && (AgentSet.getTurtleVariable(3) > 0)) && (AgentSet.getTurtleVariable(3) < (world.maxPxcor - 8)))) {
AgentSet.setBreed(world.turtlesOfBreed("IRS"))
AgentSet.setTurtleVariable(2,20)
AgentSet.setTurtleVariable(1,125)
} else {
AgentSet.setTurtleVariable(2,(100 + Random.nextLong(160)))
}
} });
};
function RUN_IR () {
AgentSet.ask(world.turtlesOfBreed("IRS"), true, function(){ if (!(MY_CAN_MOVE_P(0.3))) {
AgentSet.die()
}
Prims.fd(0.3)
if ((AgentSet.getTurtleVariable(4) <= Globals.getGlobal(3))) {
AgentSet.setBreed(world.turtlesOfBreed("HEATS"))
Prims.right(Random.nextLong(45))
Prims.left(Random.nextLong(45))
AgentSet.setTurtleVariable(1,((15 - 2) + Random.nextLong(4)))
}
if (AgentSet.any(AgentSet.self().breedHere("CO2S"))) {
AgentSet.setTurtleVariable(2,(180 - AgentSet.getTurtleVariable(2)))
} });
};
function ADD_CO2 () {
var SKY_HEIGHT = (Globals.getGlobal(2) - Globals.getGlobal(3));
AgentSet.ask(world.createturtles(25, "CO2S"), true, function(){ AgentSet.setTurtleVariable(1,55)
Prims.setxy(Prims.randomxcor(), (Globals.getGlobal(3) + Prims.randomfloat(SKY_HEIGHT))) });
};
function REMOVE_CO2 () {
for(var i = 0; i < 25; i++) { if (AgentSet.any(world.turtlesOfBreed("CO2S"))) {
AgentSet.ask(AgentSet.oneOf(world.turtlesOfBreed("CO2S")), true, function(){ AgentSet.die() });
} }
};
function RUN_CO2 () {
AgentSet.ask(world.turtlesOfBreed("CO2S"), true, function(){ Prims.right((Random.nextLong(51) - 25))
var DIST = (0.05 + Prims.randomfloat(0.1));
if (AgentSet.of(AgentSet.self().patchAhead(DIST), function(){ return !(Prims.shadeOf(105, AgentSet.getPatchVariable(2))) })) {
AgentSet.setTurtleVariable(2,(180 - AgentSet.getTurtleVariable(2)))
}
Prims.fd(DIST) });
};
function MY_CAN_MOVE_P (AMOUNT) {
var NEW_Y = (AgentSet.getTurtleVariable(4) + (AMOUNT * Trig.unsquashedCos(AgentSet.getTurtleVariable(2))));
if ((AgentSet.getTurtleVariable(4) > 0)) {
return (NEW_Y < (world.maxPycor + 0.5));
} else {
return (NEW_Y >= (world.minPycor - 0.5));
}
};
function MY_LENGTH (L) {
if (L.length !== 0) {
return (1 + MY_LENGTH(Prims.butfirst(L)));
} else {
return 0;
}
};
Globals.setGlobal(0,0)
Globals.setGlobal(1,100)
    </script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">

      var session     = new SessionLite(document.getElementsByClassName('view-container')[0])
      var runner      = -1;
      var tickCounter = document.getElementById('tick-counter');
      var tempMonitor = document.getElementById('temp-monitor');
      var cloudSlider = document.getElementById('cloud-slider');
      var cloudLabel  = document.getElementById('cloud-label');
      var co2Slider   = document.getElementById('co2-slider');
      var co2Label    = document.getElementById('co2-label');
      var lastUpdate  = 0;
      var chart       = null;
      var data        = null;

      google.load('visualization', '1', {packages:['corechart']});
      google.setOnLoadCallback(drawPlot);

      function drawPlot() {
        chart = new google.visualization.LineChart(document.getElementById('chart-div'));
        resetData();
        setInterval(plot.bind(this, data), 100);
      }

      function resetData() {
        data = new google.visualization.DataTable();
        data.addColumn('number', 'Tick');
        data.addColumn('number', 'Temperature');
        data.setColumnProperty(0, 'type', 'number');
        data.setColumnProperty(1, 'type', 'number');
        chart.draw(data);
      }

      function plotPoint(tick, y) {
        if (tick % 20 === 0) {
          data.addRow([tick,y]);
        }
      }

      function plot(data) {
        var opts = {
          backgroundColor: '#fcfdfd',
          chartArea:{width:"80%"},
          enableInteractivity: false,
          legend: {position: 'top', textStyle: {color: 'blue', fontSize: 12}, alignment:'center'},
          vAxis: {maxValue: 30},
          hAxis: {maxValue: 10000}
        };
        chart.draw(data, opts);
      }

      // If the HTML was saved in the non-default state, correct it.
      tickCounter.textContent = '0';
      tempMonitor.textContent = '0';
      cloudSlider.value       = 0;
      cloudLabel.innerHTML    = 0 + '%';
      co2Slider.value         = 100;
      co2Label.innerHTML      = 100;
      document.getElementById('go-button').value = 'Go';

      function onCloudChange() {
         cloudLabel.innerHTML = cloudSlider.value + '%';
      }

      function onCO2Change() {
        co2Label.innerHTML = co2Slider.value;
      }

      function updateInterfaceGlobals() {
        Globals.setGlobal(0, cloudSlider.value);
        Globals.setGlobal(1, co2Slider.value);
      }

      function updateTempMonitor() {
        tempMonitor.textContent = typeof Globals.getGlobal(4) === 'number' ? Globals.getGlobal(4).toFixed(1) : '';
      }

      function updateTickCounter() {
        tickCounter.textContent = typeof world.ticks() === 'number' ? world.ticks() : '';
      }

      function goForever() {

        var speed      = Math.exp(document.getElementById('speed-slider').value);
        var delta      = Math.min(new Date().getTime() - lastUpdate, 30);
        var numUpdates = speed * delta / 1000 + 1;

        for (var i=0; i < numUpdates; i++) {
          updateInterfaceGlobals();
          plotPoint(world.ticks(), Number(Globals.getGlobal(4).toFixed(1)));
          GO();
        }

        updateWidgets();
        session.update(collectUpdates());

        lastUpdate = new Date().getTime();
        runner     = setTimeout(goForever, 1000 / speed);

      }

      function updateWidgets() {
        updateTempMonitor();
        updateTickCounter();
      }

      function setup() {
        updateInterfaceGlobals();
        if (data) data.removeRows(0,data.getNumberOfRows());
        SETUP();
        session.update(collectUpdates());
        updateWidgets();
      }

      function stop() {
        clearTimeout(runner);
        runner = -1;
      }

      function toggleGo() {
        var goButton = document.getElementById('go-button');
        if (runner < 0) {
          goForever();
          goButton.value = "Stop";
        } else {
          stop();
          goButton.value = "Go";
        }
      }

    </script>

</body></html>
